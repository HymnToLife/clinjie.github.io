title: v6
date: 2015-11-21 09:58:59
tags: 网络
categories: 网络
---

前几天学校每个月送的20g流量又没了，然后想到了一直有人提到过的，校园网IPv6可以使用双栈协议的服务器做跳板实现免流。经过前人 的无私奉献，很快就搭了一个三藩市的vps，这里记录一下。

# VPS的选择 #

说是VPS，实际上就是服务器，VPS也叫虚拟专用服务器，每个提供商都有自己的叫法，类似亚马逊的aws ec，linode 的node，以及digitalocean的droplet，每个提供商都有自己的特点，有的一稳定著称，有的因为高性价比文明，还有的因为网络、性能、计算方面的优势受到欢迎，因为这里主要是使用vps作为我的v6免流服务器中转，所以一下几个方面一定要考虑到：
<!--more-->
- IPv6 enable

- 低延迟

- 高流量

- 稳定

小服务提供商不用选择，容易跑路还不稳定，没有完善的文档，关键是大多数不支持IPv6，下面是一些大的提供商：

1. 亚马逊aws

2. linode

3. digitalocean

4. Vultr

5. Bandwagon

aws绑定信用卡提供最低配置的一年免费使用权，过期之后换张信用卡可以接着用，但是最低配置的不支持IPv6，还有就是aws 的扣费规则太多，容易进坑，每个月只提供20G左右的流量，泡个简单的Django可以，做ss还是算了吧

搬瓦工一直以超低价格出名，有过一段之间的不到$10，一年vps使用，不支持IPv6，被国内涌进的站长挤爆了。最近开始支持v6，不过价格也提高了，OpenVZ架构，超售严重

linode跟搬瓦工是经常拿来对比的服务商，linode是高富帅选择，每月$10起步，能提供的一般都提供了，稳定著称，不过性能与剩下的几个没有很大的优势

Vultr与Do定位类似，相同的价格下都有类似的配置，Vultr原来有日本的主机，延迟超低，实际使用体验棒，目前也售完了。这两者最低$5每月，按小时收费，DO支持v6，不限流量，Vultr不太清楚，进过慎重抉择，最终选择使用DO的旧金山主机


# DO VPS创建 #

在[DigitalOcean](https://m.do.co/c/2e32147dc5fa)主页注册用户，这是我的推广链接，推广链接注册后你会得到$10的初始credit。首次使用需要绑定信用卡/借贷卡或者paypal，使用palpay时需要最低充值$5，信用卡不需要。

注册成功后[创建](https://cloud.digitalocean.com/droplets/)页面选择创建VPS，我的选择是centos7.2,$5/month套餐，sanfrancisco区域vps。


注意下面要在IPv6选项框上打对勾，同时注意建议不要使用Provate Networking，这是在同时部署多台服务器时选择，方便之间使用网络，我第一次创建选择这个选项之后，可以正常访问国外IPv6，国内的大多数无法使用，BackUp选项会增加20%费用。


Add your SSH keys选项是为了方便我们使用安全的连接方式控制主机，可以直接使github上绑定的public key，还没有使用的网友，这里有一篇简单的介绍[百度经验](http://jingyan.baidu.com/article/ea24bc39b42ec2da62b331df.html)，保存好ppk文件和生成的ssh代码内容，复制生成的ssh内容粘贴到网页的ssh key content中，以后就可以直接使用ssh控制主机。

最后确定好实例的名字后点击create就可以了，不到1分钟属于你的vps就创建好了


# ss设置 #


使用Xshell ssh方式登录控制主机，vps用户名默认为root，登陆之后：

1. 安装ss

`wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh
chmod +x shadowsocks.sh`

一键安装


2. ss日志

`./shadowsocks.sh 2>&1 | tee shadowsocks.log`

3. 修改配置

`vi /etc/shadowsocks.json`

进入之后键盘点击i进入insert模式，清除原来的文本，粘贴下面：

```json
{
    "server":"::",
    "server_port":8989,
    "local_address":"127.0.0.1",
    "local_port":1080,
    "password":"yourpassword",
    "timeout":300,
    "method":"aes-256-cfb",
    "fast_open":false
}
```

`"server":"::"`代表监听v6请求
**注意，如果你使用的是centos7.x版本，server_port使用默认的端口号，不要乱改，否则服务器防火墙不通过也没用，多用户配置在另一片文章中有说明**
修改完后esc退出修改模式，输入`:x`或者`:wq`退出vi


4. 启动ss

`/etc/init.d/shadowsocks restart`

5. pc端设置启动

[首先安装](https://github.com/shadowsocks/shadowsocks-windows/releases/download/2.5/Shadowsocks-win-2.5.zip)shadowsocks-windows，最新版的客户端ss要求较高的.net服务，连接给出的是较老版本，[最新版本](https://github.com/shadowsocks/shadowsocks-windows/releases)

打开后->服务器->编辑服务器->添加->服务器地址填入DO的IPv6地址->服务器端口、密码、加密方式都可以在上面配置的服务器端ss文件中找到

端口号选择本地闲置端口，默认1080

系统代理模式选择全局代理，开启之后就可以畅享免流网络

5. vps网络优化

[内核修改优化](http://yooooh.net/2015/10/10/ipv6-shadowsocks/)

其中centos7.2在`vi /etc/sysctl.conf`这一步时要注意，去提示的文件中修改

6. 破解版锐速

`wget -N --no-check-certificate https://raw.githubusercontent.com/91yun/serverspeeder/master/serverspeeder-all.sh && bash serverspeeder-all.sh`


7. 百度云与迅雷代理下载

在两种下载工具中设置高级下载代理，选择socket5协议，端口为本地ss端口，默认1080
